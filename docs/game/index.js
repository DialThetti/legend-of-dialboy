(()=>{"use strict";var t={657:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AStar=void 0,e.AStar=class{constructor(t){this.gameState=t}getPath(t,e){const i=this.buildGrid();return this.setStep({x:Math.round(e.x),y:Math.round(e.y)},i,0),this.gridToPath(i,t).map((e=>({x:e.x-t.x,y:e.y-t.y})))}gridToPath(t,e){var i,s,n;const o=[];let a=e,r=10;do{a=this.getMin(t,a),o.push(a),r--}while(0!=r&&0!=(null!==(n=null===(s=null===(i=t[a.x])||void 0===i?void 0:i[a.y])||void 0===s?void 0:s.steps)&&void 0!==n?n:0));return o}getMin(t,e){let i=99,s=e;const n=[()=>{var n,o,a;const r=null!==(a=null===(o=null===(n=t[e.x-1])||void 0===n?void 0:n[e.y])||void 0===o?void 0:o.steps)&&void 0!==a?a:99;r<=i&&(i=r,s={x:e.x-1,y:e.y})},()=>{var n,o,a;const r=null!==(a=null===(o=null===(n=t[e.x+1])||void 0===n?void 0:n[e.y])||void 0===o?void 0:o.steps)&&void 0!==a?a:99;r<=i&&(i=r,s={x:e.x+1,y:e.y})},()=>{var n,o,a;const r=null!==(a=null===(o=null===(n=t[e.x])||void 0===n?void 0:n[e.y-1])||void 0===o?void 0:o.steps)&&void 0!==a?a:99;r<=i&&(i=r,s={x:e.x,y:e.y-1})},()=>{var n,o,a;const r=null!==(a=null===(o=null===(n=t[e.x])||void 0===n?void 0:n[e.y+1])||void 0===o?void 0:o.steps)&&void 0!==a?a:99;r<=i&&(i=r,s={x:e.x,y:e.y+1})}];return this.shuffle(n),n.forEach((t=>t())),s}shuffle(t){let e,i=t.length;for(;0!=i;)e=Math.floor(Math.random()*i),i--,[t[i],t[e]]=[t[e],t[i]];return t}setStep(t,e,i){var s;t.x<0||t.y<0||t.x>15||t.y>11||e[t.x][t.y].solid||(null!==(s=e[t.x][t.y].steps)&&void 0!==s?s:99)<i||(e[t.x][t.y].steps=i,this.setStep({x:t.x-1,y:t.y},e,i+1),this.setStep({x:t.x+1,y:t.y},e,i+1),this.setStep({x:t.x,y:t.y-1},e,i+1),this.setStep({x:t.x,y:t.y+1},e,i+1))}buildGrid(){const t=[];for(let e=0;e<16;e++){t.push([]);for(let i=0;i<12;i++)t[e][i]={solid:this.gameState.isSolidTile({x:e,y:i})}}return t}}},115:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CoreModule=void 0;const n=i(678),o=i(563),a=i(7),r=i(177),l=i(255),h=i(957),c=i(906);class d{constructor(t){this.sharedModule=t,this.gameState=new c.GameState}main(){return s(this,void 0,void 0,(function*(){const t=new o.KeyListener(this.sharedModule.loggerService);this.gameState.player=new l.PlayerEntity(this.gameState),yield this.gameState.player.load();const e=new a.PlayerController(this.gameState,this.gameState.player,t);this.gameState.mapEntity=new h.MapEntity(this.gameState),yield this.gameState.mapEntity.load(),yield this.gameState.mapEntity.loadChunk(),t.start(),Date.now(),r.Timer.repeat((t=>{e.update(t),this.gameState.pause||this.gameState.getEntities().forEach((e=>e.update(t)))})).start()}))}static get(){return s(this,void 0,void 0,(function*(){return d.instance||(d.instance=new d(yield n.SharedModule.get()),yield d.instance.main()),d.instance}))}}e.CoreModule=d},906:function(t,e){var i=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.GameState=e.items=void 0,e.items=["Sword","Dash"],e.GameState=class{constructor(){this.inventory={equippedA:"Sword",swordL1:!1,rupees:0,keys:0,bombs:0},this.pause=!1,this.entities=[],window.setRupees=t=>this.inventory.rupees=t,window.setBombs=t=>this.inventory.bombs=t,window.setKeys=t=>this.inventory.keys=t}load(){return i(this,void 0,void 0,(function*(){}))}isSolidTile(t){return!this.player.state.ghost&&this.mapEntity.tileMap.getChunk(this.mapEntity.state.currentMapId).isSolid(t)}getEntities(){return[this.mapEntity,this.player,...this.entities]}}},563:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyListener=void 0,e.KeyListener=class{constructor(t){this.loggerService=t,this.keys={LEFT:!1,RIGHT:!1,UP:!1,DOWN:!1,A:!1,B:!1,START:!1,SELECT:!1,debug:!1}}keyDown(t){switch(t.key){case"w":this.keys.UP=!0;break;case"a":this.keys.LEFT=!0;break;case"s":this.keys.DOWN=!0;break;case"d":this.keys.RIGHT=!0;break;case" ":this.keys.A=!0;break;case"Backspace":this.keys.SELECT=!0;break;case"<":this.keys.debug=!this.keys.debug,this.keys.debug?window.debug=1:delete window.debug;break;default:this.loggerService.log(t.key)}}keyUp(t){switch(t.key){case"w":this.keys.UP=!1;break;case"a":this.keys.LEFT=!1;break;case"s":this.keys.DOWN=!1;break;case"d":this.keys.RIGHT=!1;break;case"<":break;case"Backspace":this.keys.SELECT=!1;break;case" ":this.keys.A=!1}}keyPress(t){var e;(null===(e=this.isPressedObserver)||void 0===e?void 0:e.call(this,t))&&delete this.isPressedObserver}start(){document.addEventListener("keydown",(t=>this.keyDown(t)),!1),document.addEventListener("keyup",(t=>this.keyUp(t)),!1),document.addEventListener("keypress",(t=>this.keyPress(t)),!1)}}},318:function(t,e){var i=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.loadJson=e.loadImage=void 0,e.loadImage=function(t){return i(this,void 0,void 0,(function*(){return new Promise((e=>{var i;const s=document.querySelector(`[data-id="${t}"]`);if(s)return e(s);const n=new Image;n.dataset.id=t,n.src=t,n.onload=()=>e(n),null===(i=document.querySelector("#img-reg"))||void 0===i||i.appendChild(n)}))}))},e.loadJson=function(t){return i(this,void 0,void 0,(function*(){const e=yield fetch(t);return yield e.json()}))}},224:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Math2d=void 0,e.Math2d=class{static scale(t,e){return{x:t.x*e,y:t.y*e}}static norm(t){const e=Math.sqrt(t.x*t.x+t.y*t.y);return{x:t.x/e,y:t.y/e}}static add(t,e){return{x:t.x+e.x,y:t.y+e.y}}}},26:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e,i={x:0,y:0}){this.pos=t,this.size=e,this.offset=i}overlaps(t){return this.bottom>t.top&&this.top<t.bottom&&this.left<t.right&&this.right>t.left}get bottom(){return this.pos.y+this.size.y+this.offset.y}set bottom(t){this.pos.y=t-(this.size.y+this.offset.y)}get top(){return this.pos.y+this.offset.y}set top(t){this.pos.y=t-this.offset.y}get left(){return this.pos.x+this.offset.x}set left(t){this.pos.x=t-this.offset.x}get right(){return this.pos.x+this.size.x+this.offset.x}set right(t){this.pos.x=t-(this.size.x+this.offset.x)}}},7:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerController=void 0;const o=i(906),a=n(i(26)),r=i(224);e.PlayerController=class{constructor(t,e,i){this.gameState=t,this.player=e,this.keyListener=i,this.blockTrigger=!1,this.speed=1/15,this.weaponChanged=!1}update(t){return s(this,void 0,void 0,(function*(){const{state:t}=this.player;if(!t.presentItem)if(this.player.state.ghost=this.keyListener.keys.debug,this.setMovementByKeys(t),this.mapTransition(),this.keyListener.keys.SELECT){if(!this.weaponChanged){let t=o.items.findIndex((t=>t===this.gameState.inventory.equippedA))+1;t>=o.items.length&&(t=0),this.gameState.inventory.equippedA=o.items[t],this.weaponChanged=!0}}else this.weaponChanged=!1}))}setMovementByKeys(t){if(this.gameState.pause)this.keyListener.isPressedObserver||(this.keyListener.isPressedObserver=t=>(" "===t.key&&(this.gameState.pause=!1,delete this.gameState.dialog),!1));else if(0==t.forcedWay&&(this.keyListener.keys.LEFT?(t.direction="LEFT",t.velocity={x:-1,y:0},t.step+=1):this.keyListener.keys.RIGHT?(t.velocity={x:1,y:0},t.direction="RIGHT",t.step+=1):this.keyListener.keys.UP?(t.direction="UP",t.velocity={x:0,y:-1},t.step+=1):this.keyListener.keys.DOWN?(t.direction="DOWN",t.velocity={x:0,y:1},t.step+=1):(t.step=0,t.velocity={x:0,y:0}),t.step>10&&(t.step-=10),this.keyListener.keys.A))switch(this.gameState.inventory.equippedA){case"Sword":t.attack=h.get(this.player);break;case"Dash":t.attack=l.get(this.player)}}mapTransition(){return s(this,void 0,void 0,(function*(){if(!this.blockTrigger)if(this.player.state.position.x<-.5){this.player.state.position.x+=15.5;const t=this.gameState.mapEntity.state.currentMapId,e=(parseInt(t,16)-1).toString(16);this.gameState.mapEntity.state.currentMapId=e,yield this.gameState.mapEntity.loadChunk()}else if(this.player.state.position.x>15.5){this.player.state.position.x-=15.5;const t=this.gameState.mapEntity.state.currentMapId,e=(parseInt(t,16)+1).toString(16);this.gameState.mapEntity.state.currentMapId=e,yield this.gameState.mapEntity.loadChunk()}else if(this.player.state.position.y<-.5){this.player.state.position.y+=11.5;const t=this.gameState.mapEntity.state.currentMapId,e=(parseInt(t,16)-16).toString(16);this.gameState.mapEntity.state.currentMapId=e,yield this.gameState.mapEntity.loadChunk()}else if(this.player.state.position.y>11.5){this.player.state.position.y-=12;const t=this.gameState.mapEntity.state.currentMapId,e=(parseInt(t,16)+16).toString(16);this.gameState.mapEntity.state.currentMapId=e,yield this.gameState.mapEntity.loadChunk()}}))}};class l{static get(t){if(t.state.attack)return t.state.attack;let e;switch(t.state.direction){case"RIGHT":e={x:1,y:0};break;case"LEFT":e={x:-1,y:0};break;case"UP":e={x:0,y:-1};break;case"DOWN":e={x:0,y:1}}return t.state.forcedWay=1/15,t.state.velocity=r.Math2d.scale(e,5),{timer:1/15+.2,area:[t.hitBox],properties:["invicible"],next:{timer:1,area:[],properties:["cooldown"]}}}}class h{static get(t){let e={x:0,y:0},i={x:0,y:0};switch(t.state.direction){case"RIGHT":i={x:1,y:0};break;case"LEFT":e={x:-1,y:0},i={x:1,y:0};break;case"UP":e={x:0,y:-1},i={x:0,y:1};break;case"DOWN":i={x:0,y:1}}return{timer:.2,area:[new a.default(r.Math2d.add(t.state.position,e),r.Math2d.add({x:t.hitBox.size.x,y:t.hitBox.size.y},i),t.hitBox.offset)]}}}},610:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TileCollider=void 0,e.TileCollider=class{constructor(t){this.gameState=t,this.t=[]}collidesWithTiles(t){let e=[];const{top:i,bottom:s,left:n,right:o}=t.hitBox;return t.state.velocity.y<0?e=[{x:Math.floor(n),y:Math.floor(i)},{x:Math.floor(o),y:Math.floor(i)}]:t.state.velocity.y>0?e=[{x:Math.floor(n),y:Math.floor(s)},{x:Math.floor(o),y:Math.floor(s)}]:t.state.velocity.x<0?e=[{x:Math.floor(n),y:Math.floor(i)},{x:Math.floor(n),y:Math.floor(s)}]:t.state.velocity.x>0&&(e=[{x:Math.floor(o),y:Math.floor(i)},{x:Math.floor(o),y:Math.floor(s)}]),this.t=e.filter((t=>this.gameState.isSolidTile(t))),this.t}render(t){t.strokeStyle="red",this.t.forEach((e=>{t.strokeRect(16*e.x+1,48+16*e.y+1,14,14)})),this.t=[]}}},694:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Chunk=e.TilesBasedMap=void 0;const o=i(318),a=n(i(26)),r=i(483),l=i(733);class h{constructor(t,e){this.definitionFile=t,this.tilesets=e}mapIdToPosition(t){const e=parseInt(t,16);let i=Math.floor(e/16);return{x:16*(e-16*i),y:12*i}}getChunk(t,e=!1){var i,s;const n=this.mapIdToPosition(t),o=this.definitionFile.layers.filter((t=>e?"top"===t.name:"top"!==t.name)).map((t=>(0,l.isInfiniteLayer)(t)?t.chunks.filter((t=>t.x===n.x&&t.y===n.y)):null)).filter((t=>!!t)).map((t=>t.map((t=>t.data)))).map((t=>t.flatMap(((t,e)=>[...t,e]),[]))),r=(null!==(s=null===(i=this.definitionFile.layers.find((t=>"objectgroup"===t.type)))||void 0===i?void 0:i.objects)&&void 0!==s?s:[]).map((t=>Object.assign(Object.assign({},t),{x:t.x/16-n.x,y:t.y/16-n.y,width:t.width/16,height:t.height/16}))).filter((t=>new a.default({x:t.x,y:t.y},{x:t.width,y:t.height}).overlaps(new a.default({x:0,y:0},{x:16,y:12}))));return new c(o,this,r)}static load(t){return s(this,void 0,void 0,(function*(){const e=t.substring(0,t.lastIndexOf("/")),i=yield(0,o.loadJson)(t),n=yield Promise.all(i.tilesets.map((t=>s(this,void 0,void 0,(function*(){return yield r.Tileset.load(e+"/"+t.source,t.firstgid)}))))),a=t=>{var e;return null===(e=t.properties.find((t=>"zindex"===t.name)))||void 0===e?void 0:e.value};return new h(Object.assign(Object.assign({},i),{layers:[...i.layers.filter((t=>t.visible)).filter((t=>"tilelayer"===t.type)).sort(((t,e)=>a(t)-a(e))),...i.layers.filter((t=>"objectgroup"===t.type))]}),n)}))}}e.TilesBasedMap=h;class c{constructor(t,e,i){this.data=t,this.parent=e,this.obj=i}draw(t,e){for(let i=0;i<this.data.length;i++){const s=this.data[i];for(let i=0;i<s.length;i++){const n=Math.floor(i/16),o=i-16*n,a=this.parent.tilesets.map((t=>t.getTile(s[i]))).find((t=>t));null==a||a.draw(t,{x:16*o+e.x,y:16*n+e.y})}}}getTilesAt(t){var e;let i={};for(let s=0;s<this.data.length;s++){const n=this.data[s];if(t.x>15||t.y>11||t.x<0||t.y<0)return{};const o=null===(e=this.parent.tilesets.map((e=>e.getTile(n[t.x+16*t.y]))).find((t=>t)))||void 0===e?void 0:e.getMetadata();i=Object.assign(Object.assign({},i),o)}return i}isSolid(t){return!0===this.getTilesAt({x:Math.floor(t.x),y:Math.floor(t.y)}).solid}}e.Chunk=c},733:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isFiniteLayer=e.isInfiniteLayer=void 0,e.isInfiniteLayer=function(t){return"chunks"in t},e.isFiniteLayer=function(t){return"data"in t}},483:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=e.Tileset=void 0;const n=i(318);class o{constructor(t,e,i){this.image=t,this.definition=e,this.firstId=i}getTile(t){const e=t-this.firstId;return e<0||e>=this.definition.tilecount?null:new a(this,e)}static load(t,e){return s(this,void 0,void 0,(function*(){const i=yield(0,n.loadJson)(t),s=yield(0,n.loadImage)("./tiles/"+i.image);return new o(s,i,e)}))}}e.Tileset=o;class a{constructor(t,e){this.parent=t,this.id=e,this.y=Math.floor(e/t.definition.columns),this.x=e-this.y*t.definition.columns}draw(t,e){t.drawImage(this.parent.image,16*this.x,16*this.y,16,16,e.x,e.y,16,16)}getMetadata(){var t,e,i;const s=null!==(i=null===(e=null===(t=this.parent.definition.tiles)||void 0===t?void 0:t.find((t=>t.id===this.id)))||void 0===e?void 0:e.properties)&&void 0!==i?i:[];return 0!=s.length?s.reduce(((t,e)=>Object.assign(Object.assign({},t),{[e.name]:e.value})),{}):{}}}e.Tile=a},791:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GrassEntity=void 0;const o=n(i(26)),a=i(28);e.GrassEntity=class{load(t){return s(this,void 0,void 0,(function*(){this.renderer=new r(this),yield this.renderer.load(),this.state={position:{z:0,x:Math.round(t.x),y:Math.round(t.y)},velocity:{x:0,y:0},direction:"DOWN"}}))}update(t){}get hitBox(){return new o.default(this.state.position,{x:1,y:1})}};class r{constructor(t){this.entity=t}load(){return s(this,void 0,void 0,(function*(){this.spritesheet=yield a.SpriteSheet.of("./gfx/16x16/RGW_Forest.png",{grass:{x:448,y:16,w:16,h:16}})}))}render(t,e){var i;null===(i=this.spritesheet.getSprite("grass"))||void 0===i||i.draw(t,{x:16*this.entity.state.position.x,y:16*this.entity.state.position.y+48})}}},682:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ItemEntity=void 0;const n=i(637);e.ItemEntity=class{load(t){return s(this,void 0,void 0,(function*(){this.renderer=new n.ItemRenderer(this),yield this.renderer.load(),this.state=t}))}}},637:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ItemRenderer=void 0;const n=i(697),o=i(28);e.ItemRenderer=class{constructor(t){this.entity=t}load(){return s(this,void 0,void 0,(function*(){const t=yield o.SpriteSheet.of("./gfx/pausescreen.png",{swordL1:{x:555,y:137,w:8,h:16}});this.anim=new n.Animation(t,{swordL1:{steps:["swordL1"],duration:0}})}))}render(t,e){return s(this,void 0,void 0,(function*(){this.anim.getSprite(this.entity.state.id,e).draw(t,{x:Math.floor(16*this.entity.state.position.x),y:Math.floor(16*(4+this.entity.state.position.y)-6)}),window.debug&&(t.strokeStyle="blue",t.strokeRect(16*this.entity.state.position.x,64+16*this.entity.state.position.y-6,16,16))}))}}},957:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MapEntity=void 0;const o=n(i(26)),a=i(791),r=i(416),l=i(710),h=i(694);e.MapEntity=class{constructor(t){this.gameState=t}load(t="overworld"){return s(this,void 0,void 0,(function*(){this.tileMap=yield h.TilesBasedMap.load(`./tiled/${t}.map.json`),this.renderer=new l.MapRenderer(this),yield this.renderer.load(),this.state={position:{x:0,y:0,z:0},currentMapId:"8c",velocity:{x:0,y:0},direction:"DOWN"}}))}update(t){}get hitBox(){return new o.default({x:0,y:0},{x:0,y:0})}collidesWithEvent(t){var e,i,n;return s(this,void 0,void 0,(function*(){const s=this.tileMap.getChunk(this.state.currentMapId).obj.find((e=>new o.default({x:e.x,y:e.y},{x:e.width,y:e.height}).overlaps(t.hitBox)));if(s){const o=JSON.parse(null!==(i=null===(e=s.properties.find((t=>"payload"===t.name)))||void 0===e?void 0:e.value)&&void 0!==i?i:"{}");switch(null===(n=s.properties.find((t=>"type"===t.name)))||void 0===n?void 0:n.value){case"teleport":yield this.load(o.map),this.state.currentMapId=o.mapId,yield this.loadChunk(),t.state.position={x:o.x,y:o.y,z:t.state.position.z};break;case"entity":break;default:console.log(s)}}}))}interact(t){var e,i,n;return s(this,void 0,void 0,(function*(){const s=this.tileMap.getChunk(this.state.currentMapId),a={x:t.hitBox.pos.x,y:t.hitBox.pos.y};switch(t.state.direction){case"DOWN":a.y+=1;break;case"UP":a.y-=1;break;case"LEFT":a.x-=1;break;case"RIGHT":a.x+=1}const r=s.obj.find((t=>new o.default({x:t.x,y:t.y},{x:t.width,y:t.height}).overlaps(new o.default(a,{x:1,y:1}))));if(r){const t=JSON.parse(null!==(i=null===(e=r.properties.find((t=>"payload"===t.name)))||void 0===e?void 0:e.value)&&void 0!==i?i:"{}");switch(null===(n=r.properties.find((t=>"type"===t.name)))||void 0===n?void 0:n.value){case"dialog":return this.gameState.pause=!0,this.gameState.dialog=t.text,!0;case"entity":break;default:console.log(r)}}return!1}))}loadChunk(){return s(this,void 0,void 0,(function*(){const t=this.tileMap.getChunk(this.state.currentMapId).obj.filter((t=>{var e;return"entity"===(null===(e=t.properties.find((t=>"type"===t.name)))||void 0===e?void 0:e.value)})).map((t=>{var e,i;return Object.assign(Object.assign({},t),{payload:JSON.parse(null!==(i=null===(e=t.properties.find((t=>"payload"===t.name)))||void 0===e?void 0:e.value)&&void 0!==i?i:"{}")})})),e=yield Promise.all(t.map((t=>s(this,void 0,void 0,(function*(){var e,i;switch(t.payload.entityType.split(":")[0]){case"grass":{const e=new a.GrassEntity;return yield e.load(t),e}case"slime":{const s=t.payload.entityType.split(":")[1],n=new r.SlimeEntity(this.gameState);return yield n.load({position:{x:t.x,y:t.y,z:5},direction:"DOWN",color:s,velocity:{x:0,y:0},speed:null!==(e={GREEN:1,RED:1.5,BLUE:2,VIOLET:3}[s])&&void 0!==e?e:1,sleepTime:null!==(i={GREEN:1,RED:.75,BLUE:.5,VIOLET:0}[s])&&void 0!==i?i:1}),n}}})))).filter((t=>t)));this.gameState.entities=e}))}}},710:function(t,e){var i=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MapRenderer=void 0,e.MapRenderer=class{constructor(t){this.entity=t}load(){return i(this,void 0,void 0,(function*(){}))}render(t,e){t.fillStyle="black",t.fillRect(0,0,256,240),this.entity.tileMap.getChunk(this.entity.state.currentMapId).draw(t,{x:0,y:48})}renderTop(t,e){this.entity.tileMap.getChunk(this.entity.state.currentMapId,!0).draw(t,{x:0,y:48})}}},656:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerAnimation=void 0;const o=i(697),a=i(28),r=n(i(36)),l=n(i(832));class h extends o.Animation{constructor(t,e){super(t,e)}static load(){return s(this,void 0,void 0,(function*(){const t=yield a.SpriteSheet.of("./gfx/chars/Character 1.png",l.default);return new h(t,r.default)}))}}e.PlayerAnimation=h},255:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerEntity=void 0;const o=i(336),a=n(i(26)),r=i(610);e.PlayerEntity=class{constructor(t){this.gameState=t}load(){return s(this,void 0,void 0,(function*(){this.renderer=new o.PlayerRenderer(this),this.tileCollider=new r.TileCollider(this.gameState),yield this.renderer.load(),this.state={hearts:{current:3,max:3},direction:"DOWN",position:{x:3.3,y:4,z:100},velocity:{x:0,y:0},step:0,speed:3,ghost:!1,forcedWay:0,entityGhost:0}}))}update(t){var e,i,n,o,a,r;return s(this,void 0,void 0,(function*(){this.state.attack&&(!(null===(i=null===(e=this.state.attack)||void 0===e?void 0:e.properties)||void 0===i?void 0:i.includes("cooldown"))&&(yield this.gameState.mapEntity.interact(this))?this.state.attack.timer=0:(this.state.attack.timer-=t,this.gameState.entities.forEach((t=>{var e;return null===(e=this.state.attack)||void 0===e?void 0:e.area.forEach((e=>{var i,s;t.hitBox.overlaps(e)&&(null===(s=(i=t).damage)||void 0===s||s.call(i))}))}))),(null===(n=this.state.attack)||void 0===n?void 0:n.timer)<=0&&((null===(o=this.state.attack)||void 0===o?void 0:o.next)?this.state.attack=this.state.attack.next:delete this.state.attack)),this.state.entityGhost>=0&&(this.state.entityGhost-=t),this.state.presentItem&&(this.state.presentItem.timer-=t,this.state.presentItem.timer<=0&&delete this.state.presentItem),this.state.forcedWay>0?(this.state.forcedWay-=t,this.move(5,t)||(this.state.forcedWay=-1),this.state.forcedWay<0&&(this.state.velocity={x:0,y:0},this.state.forcedWay=0)):this.state.attack&&!(null===(r=null===(a=this.state.attack)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.includes("cooldown"))||this.move(this.state.speed,t)}))}move(t,e){return s(this,void 0,void 0,(function*(){return this.state.position.x+=this.state.velocity.x*t*e,this.state.position.y+=this.state.velocity.y*t*e,this.state.position.x=Math.round(16*this.state.position.x)/16,this.state.position.y=Math.round(16*this.state.position.y)/16,this.tileCollider.collidesWithTiles(this).length>0?(this.state.position.x-=this.state.velocity.x*t*e,this.state.position.y-=this.state.velocity.y*t*e,this.state.position.x=Math.round(16*this.state.position.x)/16,this.state.position.y=Math.round(16*this.state.position.y)/16,!1):(this.gameState.mapEntity.collidesWithEvent(this),!0)}))}get hitBox(){return new a.default(this.state.position,{x:.75,y:.75},{x:6/16,y:2/16})}hit(t,e){var i,s;this.state.entityGhost>0||(null===(s=null===(i=this.state.attack)||void 0===i?void 0:i.properties)||void 0===s?void 0:s.includes("invicible"))||(this.state.hearts.current-=.5,0==this.state.hearts.current&&(alert("dead"),window.location=window.location),this.state.velocity=e,this.state.forcedWay=.1,this.state.entityGhost=1)}}},336:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerRenderer=void 0;const n=i(656),o=i(682);e.PlayerRenderer=class{constructor(t){this.entity=t}load(){return s(this,void 0,void 0,(function*(){this.playerAnim=yield n.PlayerAnimation.load()}))}render(t,e){var i;return s(this,void 0,void 0,(function*(){let s;if(this.entity.state.presentItem){s="presentItem";const i=new o.ItemEntity;yield i.load({id:this.entity.state.presentItem.item,position:{x:this.entity.state.position.x+.25,y:this.entity.state.position.y-1.25,z:this.entity.state.position.z},velocity:{x:0,y:0},direction:"DOWN"}),i.renderer.render(t,e)}else s=this.entity.state.direction+"_"+(0===this.entity.state.step?"IDLE":"WALK");this.entity.state.entityGhost>=0&&(t.filter="sepia(100%)"),this.playerAnim.getSprite(s,e).draw(t,{x:Math.floor(16*this.entity.state.position.x),y:Math.floor(16*(3+this.entity.state.position.y)-6)}),t.filter="none",this.entity.state.attack&&(null===(i=this.entity.state.attack)||void 0===i||i.area.forEach((e=>{t.strokeRect(16*e.left,48+16*e.top,16*e.size.x,16*e.size.y)}))),window.debug&&(t.strokeStyle="blue",t.strokeRect(16*this.entity.state.position.x,48+16*this.entity.state.position.y-6,16,16),t.strokeStyle="red",t.strokeRect(16*this.entity.hitBox.left,48+16*this.entity.hitBox.top,16*this.entity.hitBox.size.x,16*this.entity.hitBox.size.y),this.entity.tileCollider.render(t))}))}}},179:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SlimeMovementAI=void 0;const s=i(657);e.SlimeMovementAI=class{update(t,e,i){if(e.stepTimer>0)e.position.x+=e.velocity.x*t*e.speed,e.position.y+=e.velocity.y*t*e.speed,e.stepTimer-=t*e.speed,e.stepTimer<=0&&(e.position.x=Math.round(e.position.x),e.position.y=Math.round(e.position.y),e.currentSleepTime=e.sleepTime);else{if(e.currentSleepTime>0)return void(e.currentSleepTime-=t);if(!(Math.random()<.5)){const t=new s.AStar(i).getPath(e.position,i.player.state.position);return e.velocity=t[0],e.stepTimer=1,void this.getDirectionByVelocity(e)}{let t=10;do{e.stepTimer=1,Math.random()>.5?e.velocity={x:0,y:Math.random()>.5?1:-1}:e.velocity={x:Math.random()>.5?1:-1,y:0},this.getDirectionByVelocity(e);const s={x:e.position.x+e.velocity.x,y:e.position.y+e.velocity.y};i.isSolidTile(s)||s.x<0||s.y<0||s.x>15||s.y>11?(t--,t<=0&&(console.log("give up for ",s),e.velocity={x:0,y:0},e.stepTimer=0)):t=-1}while(t>=0)}}}getDirectionByVelocity(t){0==t.velocity.x?t.direction=t.velocity.y>0?"DOWN":"UP":t.direction=t.velocity.x>0?"RIGHT":"LEFT"}}},416:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.SlimeEntity=void 0;const o=i(293),a=i(179),r=n(i(26)),l=i(224);class h{constructor(t){this.gameState=t}load(t){var e;return s(this,void 0,void 0,(function*(){this.state=Object.assign(Object.assign({stepTimer:0,currentSleepTime:Math.random(),sleepTime:1,speed:1,color:null!==(e=t.color)&&void 0!==e?e:"GREEN"},t),{dead:!1}),this.renderer=new o.SlimeRenderer(this),yield this.renderer.load()}))}update(t){if(!this.state.dead&&(h.slimeMovementAI.update(t,this.state,this.gameState),this.hitBox.overlaps(this.gameState.player.hitBox))){console.log("pompf");const t=this.gameState.player.state.position,e=this.state.position;this.gameState.player.hit(0,l.Math2d.norm({x:t.x-e.x,y:t.y-e.y}))}}get hitBox(){return new r.default(this.state.position,{x:1,y:1})}damage(){this.state.dead=!0}}e.SlimeEntity=h,h.slimeMovementAI=new a.SlimeMovementAI},293:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.SlimeRenderer=void 0;const o=i(697),a=i(28),r=n(i(61)),l=n(i(832));e.SlimeRenderer=class{constructor(t){this.entity=t}load(){return s(this,void 0,void 0,(function*(){const t=yield a.SpriteSheet.of({GREEN:"./gfx/enemies/Enemy_001.png",RED:"./gfx/enemies/Enemy_002.png",BLUE:"./gfx/enemies/Enemy_003.png",VIOLET:"./gfx/enemies/Enemy_004.png"}[this.entity.state.color],l.default);this.anim=new o.Animation(t,r.default)}))}render(t,e){return s(this,void 0,void 0,(function*(){this.entity.state.dead||this.anim&&(this.anim.getSprite(this.entity.state.direction+"_"+(this.entity.state.stepTimer>0?"WALK":"IDLE"),e*this.entity.state.speed).draw(t,{x:Math.floor(16*this.entity.state.position.x-4),y:Math.floor(16*(3+this.entity.state.position.y)-6-4)}),window.debug&&(t.strokeStyle="blue",t.strokeRect(16*this.entity.state.position.x,16*(3+this.entity.state.position.y),16,16)))}))}}},395:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.GameModule=void 0;const n=i(351);class o{constructor(t){this.render=t,document.title="The Legend of Dialboy"}static get(){return s(this,void 0,void 0,(function*(){return o.instance||(o.instance=new o(yield n.RenderModule.get())),o.instance}))}}e.GameModule=o},697:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=void 0,e.Animation=class{constructor(t,e){this.spriteSheet=t,this.animationDef=e,this.timer=0}getSprite(t,e){var i;this.lastAnim!=t&&(this.lastAnim=t,this.timer=0);const s=this.animationDef[t];let n;this.timer+=e,this.timer>=s.steps.length*s.duration&&(this.timer-=s.steps.length*s.duration),n=0==s.duration?0:Math.floor(this.timer/s.duration);const o=s.steps[n];return null!==(i=this.spriteSheet.getSprite(o))&&void 0!==i?i:this.spriteSheet.getSprite(s.steps[0])}}},28:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=e.SpriteSheet=void 0;const n=i(318);class o{constructor(t,e){this.img=t,this.sprites={},Object.entries(e).forEach((([t,e])=>{this.sprites[t]=new a(this,e)}))}getSprite(t){if(this.sprites[t])return this.sprites[t];console.warn(t+" not a sprite")}static of(t,e){return s(this,void 0,void 0,(function*(){const i=yield(0,n.loadImage)(t);return new o(i,e)}))}}e.SpriteSheet=o;class a{constructor(t,e){this.spriteSheet=t,this.rect=e}draw(t,e){t.drawImage(this.spriteSheet.img,this.rect.x,this.rect.y,this.rect.w,this.rect.h,e.x,e.y,this.rect.w,this.rect.h)}}e.Sprite=a},218:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.HUDRenderer=void 0;const n=i(28);e.HUDRenderer=class{load(t){return s(this,void 0,void 0,(function*(){const e={fullHeart:{x:627,y:117,w:8,h:8},halfHeart:{x:636,y:117,w:8,h:8},emptyHeart:{x:645,y:117,w:8,h:8},x:{x:519,y:117,w:8,h:8},back:{x:258,y:11,w:256,h:56}};for(let t=0;t<10;t++)e[t]={x:528+9*t,y:117,w:8,h:8};this.spriteSheet=yield n.SpriteSheet.of("./gfx/pausescreen.png",e),this.state=t}))}render(t,e){if(this.renderHearts(t),t.fillStyle="white",t.fillText(this.state.inventory.equippedA,8,8),this.state.dialog){t.fillStyle="black",t.fillRect(0,208,256,48),t.strokeStyle="white";for(let e=0;e<this.state.dialog.split("\n").length;e++){const i=this.state.dialog.split("\n")[e];t.strokeText(i,4,220+16*e)}}}renderItems(t){var e,i,s;t.fillStyle="black",t.fillRect(96,0,24,48);const{rupees:n,keys:o,bombs:a}=this.state.inventory,r=this.getStringByNumber(n,3);for(let i=0;i<r.length;i++)null===(e=this.spriteSheet.getSprite(r[i]))||void 0===e||e.draw(t,{x:96+8*i,y:16});const l=this.getStringByNumber(o,2);for(let e=0;e<l.length;e++)null===(i=this.spriteSheet.getSprite(l[e]))||void 0===i||i.draw(t,{x:96+8*e,y:32});const h=this.getStringByNumber(a,2);for(let e=0;e<h.length;e++)null===(s=this.spriteSheet.getSprite(h[e]))||void 0===s||s.draw(t,{x:96+8*e,y:40})}renderHearts(t){var e,i,s;t.fillStyle="black",t.fillRect(176,32,64,16);const n=Math.floor(this.state.player.state.hearts.current),o=this.state.player.state.hearts.max;for(let i=0;i<n;i++)null===(e=this.spriteSheet.getSprite("emptyHeart"))||void 0===e||e.draw(t,this.heartPos(i));Math.floor(this.state.player.state.hearts.current)!=Math.ceil(this.state.player.state.hearts.current)&&(null===(i=this.spriteSheet.getSprite("halfHeart"))||void 0===i||i.draw(t,this.heartPos(Math.floor(this.state.player.state.hearts.current))));for(let e=Math.ceil(this.state.player.state.hearts.current);e<o;e++)null===(s=this.spriteSheet.getSprite("fullHeart"))||void 0===s||s.draw(t,this.heartPos(e))}getStringByNumber(t,e){let i=`${t}`;return 3===e&&(1==i.length&&(i="0"+i),2==i.length&&(i="x"+i)),2===e&&1==i.length&&(i="x"+i),i.split("")}heartPos(t){return{x:176+8*t-64*Math.floor(t/8),y:40-8*Math.floor(t/8)}}}},351:function(t,e,i){var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))((function(n,o){function a(t){try{l(s.next(t))}catch(t){o(t)}}function r(t){try{l(s.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}l((s=s.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.RenderModule=void 0;const n=i(115),o=i(678),a=i(177),r=i(218);class l{constructor(t,e){this.core=t,this.shared=e,this.fps=60}load(){return s(this,void 0,void 0,(function*(){const t=document.getElementById("screen");this.ctx=t.getContext("2d"),this.ctx.scale(1,1);const e=new r.HUDRenderer;yield e.load(this.core.gameState),a.Timer.repeat((t=>s(this,void 0,void 0,(function*(){const i=this.core.gameState.getEntities().filter((t=>t.state)).sort(((t,e)=>t.state.position.z-e.state.position.z)).map((t=>t.renderer));for(const e of i)yield e.render(this.ctx,t);if(this.core.gameState.mapEntity.renderer.renderTop(this.ctx,t),window.debug)for(let t=0;t<16;t++)for(let e=0;e<12;e++)this.core.gameState.isSolidTile({x:t,y:e})&&(this.ctx.strokeStyle="red",this.ctx.strokeRect(16*t,16*e+48,16,16),this.ctx.beginPath(),this.ctx.moveTo(16*t,16*(e+3)),this.ctx.lineTo(16*t+16,16*(e+3)+16),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(16*t,16*(e+3)+16),this.ctx.lineTo(16*t+16,16*(e+3)),this.ctx.stroke());e.render(this.ctx,t)})))).start()}))}static get(){return s(this,void 0,void 0,(function*(){return l.instance||(l.instance=new l(yield n.CoreModule.get(),yield o.SharedModule.get()),yield l.instance.load()),l.instance}))}}e.RenderModule=l},177:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Timer=void 0;class i{constructor(t,e=1/60){this.updateFunc=t,this.deltaTime=e,this.fps=0,this.lastTime=0,this.accumulatedTime=0,this.internalFps=0,this.canceled=!1}update(t){const e=(t-this.lastTime)/1e3;for(this.accumulatedTime+=e,this.accumulatedTime>1&&(this.accumulatedTime=1,console.warn(this,"resolve sleeping"));this.accumulatedTime>this.deltaTime;)this.updateFunc(this.deltaTime),this.accumulatedTime-=this.deltaTime;this.lastTime=t,this.canceled||this.enqueue()}start(){this.enqueue(),this.updateFps()}cancel(){this.canceled=!0}enqueue(){this.internalFps++,requestAnimationFrame((t=>this.update(t)))}updateFps(){setTimeout((()=>{this.fps=this.internalFps,this.internalFps=0,this.updateFps()}),1e3)}static repeat(t,e=1/60){return new i(t,e)}}e.Timer=i},364:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LoggerService=void 0,e.LoggerService=class{log(t){console.log(t)}}},678:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SharedModule=void 0;const s=i(364);class n{constructor(){this.loggerService=new s.LoggerService}static get(){return n.instance||(n.instance=new n),n.instance}}e.SharedModule=n},61:t=>{t.exports=JSON.parse('{"DOWN_IDLE":{"steps":["DOWN1"],"duration":0},"DOWN_WALK":{"steps":["DOWN1","DOWN2","DOWN3","DOWN4"],"duration":0.2},"RIGHT_IDLE":{"steps":["RIGHT1"],"duration":0},"RIGHT_WALK":{"steps":["RIGHT1","RIGHT2","RIGHT3","RIGHT4"],"duration":0.2},"LEFT_IDLE":{"steps":["LEFT1"],"duration":0},"LEFT_WALK":{"steps":["LEFT1","LEFT2","LEFT3","LEFT4"],"duration":0.2},"UP_IDLE":{"steps":["UP1"],"duration":0},"UP_WALK":{"steps":["UP1","UP2","UP3","UP4"],"duration":0.2}}')},36:t=>{t.exports=JSON.parse('{"DOWN_IDLE":{"steps":["DOWN2"],"duration":0},"DOWN_WALK":{"steps":["DOWN1","DOWN2","DOWN3","DOWN2"],"duration":0.2},"RIGHT_IDLE":{"steps":["RIGHT2"],"duration":0},"RIGHT_WALK":{"steps":["RIGHT1","RIGHT2","RIGHT3","RIGHT2"],"duration":0.2},"LEFT_IDLE":{"steps":["LEFT2"],"duration":0},"LEFT_WALK":{"steps":["LEFT1","LEFT2","LEFT3","LEFT2"],"duration":0.2},"UP_IDLE":{"steps":["UP2"],"duration":0},"UP_WALK":{"steps":["UP1","UP2","UP3","UP2"],"duration":0.2}}')},832:t=>{t.exports=JSON.parse('{"DOWN1":{"x":0,"y":0,"w":24,"h":24},"DOWN2":{"x":24,"y":0,"w":24,"h":24},"DOWN3":{"x":48,"y":0,"w":24,"h":24},"DOWN4":{"x":72,"y":0,"w":24,"h":24},"LEFT1":{"x":0,"y":24,"w":24,"h":24},"LEFT2":{"x":24,"y":24,"w":24,"h":24},"LEFT3":{"x":48,"y":24,"w":24,"h":24},"LEFT4":{"x":72,"y":24,"w":24,"h":24},"RIGHT1":{"x":0,"y":48,"w":24,"h":24},"RIGHT2":{"x":24,"y":48,"w":24,"h":24},"RIGHT3":{"x":48,"y":48,"w":24,"h":24},"RIGHT4":{"x":72,"y":48,"w":24,"h":24},"UP1":{"x":0,"y":72,"w":24,"h":24},"UP2":{"x":24,"y":72,"w":24,"h":24},"UP3":{"x":48,"y":72,"w":24,"h":24},"UP4":{"x":72,"y":72,"w":24,"h":24}}')}},e={};(function i(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,i),o.exports})(395).GameModule.get()})();